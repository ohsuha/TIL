# socket
소켓이란 프로세스간의 통신에 사용되는 양쪽 끝단을 의미한다.
java.net 패키지를 통해 소켓 프로그래밍을 지원한다. 프로토콜에 따라 다른 종류의 소켓을 구현하여 제공한다.

## TCP/UDP
이 프로토콜은 이기종 시스템간의 통신을 위한 표준 프로토콜이며 OSI 7계층의 전송계층에 해당하는 프로토콜이다.

| **구분**        | **TCP**                                    | **UDP**                                                                |
|-----------------|--------------------------------------------|------------------------------------------------------------------------|
| **연결 방식**   | 연결형 (Connection-oriented)                  | 비연결형 (Connectionless)                                                  |
| **데이터 전달** | 신뢰성 보장: 패킷 순서 보장, 패킷 손실 시 재전송              | 신뢰성 없음: 패킷 순서 보장 안함, 패킷 손실 가능                                          |
| **속도**        | 상대적으로 느림                                   | 빠름                                                                     |
| **오버헤드**    | 더 큼: 연결 설정, 유지, 종료 필요                      | 더 적음: 연결 설정 필요 없음                                                      |
| **흐름 제어**   | 있음 (Flow control)                          | 없음                                                                     |
| **혼잡 제어**   | 있음 (Congestion control)                    | 없음                                                                     |
| **사용 사례**   | HTTP, FTP, SMTP, Telnet, SSH 등             | DNS, DHCP, SNMP, VoIP, 스트리밍, 게임 등                                      |
| **관련 클래스** | `java.net.Socket`, `java.net.ServerSocket` | `java.net.DatagramSocket`, `java.net.DatagramPacket`, `MulticastSocket` |

## TCP 소켓 프로그래밍
1. 서버 프로그램에서는 서버 소켓을 사용해서 서버 컴퓨터의 특정 포트에서 클라이언트의 연결요청을 처리할 준비를 한다.
2. 접속할 서버의 IP 주소와 포트 정보를 가지고 소켓을 생성해서 서버에 연결을 요청한다.
3. 서버 소켓은 클라이언트의 연결 요청을 받으면 서버에 새로운 소켓을 생성해서 클라이언트의 소켓과 연결하도록 한다.
4. 클라이언트의 소켓과 새로 생성된 서버의 소켓은 서버 소켓과 관계 없이 일대일 통신을 한다.

서버 소켓은 포트와 겨랍되어 포트를 통해 원격 사용자의 연결요청을 기다리다가 연결 요청이 올 때마다 새로운 소켓을 생성하여 상대편 소켓과 통신할 수 있도록 연결한다.
여기까지가 서버 소켓의 역할이고 실제적인 데이터 통신은 서버 소켓과 관계없이 소켓과 소켓간에 이루어진다.
여러개의 소켓이 하나의 포트를 공유해서 사용할 수 있지만 서버소켓은 포트를 독점한다.
한 포트를 둘 이상의 서버 소켓과 연결하게 되면 클라이언트 프로그램이 어떤 서버소켓과 연결해야하는지 알 수 없게 된다.
포트는 하나의 호스트가 65536개의 포트를 가지고 있으며 번호로 구별된다. 보통 1023번 이하의 포트는 FTP, Telnet 과 같은 기존의 다른 통신 프로그램에 의해서 사용되기 때문에 1023 이상의 번호를 사용한다.
서버 소켓은 소켓간의 연결만 처리하고 실제 데이터는 소켓들끼리 서로 주고받는데, 소켓들이 데이터를 주고받는 연결 통로는 바로 입출력 스트림이다.
소켓은 입력, 출력 스트림을 가지고 있으며 상대편 소켓과 교차 연결된다.

### 자바에서 제공하는 TCP 소켓
Socket 과 ServerSocket 클래스를 제공한다.
Socket : 프로세스간의 통신을 담당하며 InputStream, OutputStream 을 가지고 있다. 이 두 스트림을 이용해 프로세스간의 통신이 이뤄진다.
ServerSocket : 포트와 연결되어 외부의 연결 요청을 기다리다 연결 요청이 들어오면 Socket 을 생성해 소켓과 소켓간의 통신이 이뤄지도록 한다. 한 포트에 하나의 ServerSocket 만 연결할 수 있다.

서버에 접속하는 클라이언트의 수가 많을 때는 스레드를 이용해서 같은 포트로 여러개의 서버 소켓을 띄우면 클라이언트의 요청을 병렬적으로 처리할 수 있다.


## UDP 소켓 프로그래밍
UDP 소켓에서는 `DatagramSocket` 과 `DatagramPacket` 을 사용한다.
UDP는 연결지향적인 프로토콜이 아니기 때문에 `ServerSocket` 이 필요하지 않다.
UDP통신에서 사용하는 소켓은 DatagramSocket 이며 데이터를 `DatagramPacket` 에 담아서 전송한다.

`DatagramPacket` 은 헤더와 데이터로 구성되어 있으며, 헤더에는 `DatagramPacket` 을 수신할 호스트의 정보가 저장되어있다.
