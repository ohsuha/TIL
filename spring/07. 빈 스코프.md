# 빈 스코프
스프링 빈이 스프링 컨테이너의 시작과 함께 생성되어 종료될 때까지 유지된다고 학습했다.
기본적으로 싱글톤 스코프로 생성되면 위처럼 유지되지만 다양한 스코프를 지원한다.
- 싱글톤 : 기본 스코프, 스프링 컨테이너의 시작과 종료까지 유지되는 넓은 범위의 스코프이다.
- 프로토 타입 : 스프링 컨테이너는 프로토타입 빈의 생성과 의존관계 주입까지만 관여하고 더는 관리하지 않는다.
- 웹 관련 스코프
- request : 웹 요청이 들어오고 나갈때 까지 유지되는 스코프이다.
- session : 웹 세션이 생성되고 종료될 때까지 유지되는 스코프이다.
- application : 웹의 서블릿 컨텍스트와 같은 범위로 유지되는 스코프이다.

> 빈이나 컴포넌트에 @Scope("prototype") 과 같은 방식으로 적용할 수 있다.

## 프로토타입
- 스프링 컨테이너에서 빈을 조회할때 생성되고, 초기화 메서드도 실행된다.
- 스프링 컨테이너가 관리하지 않기 떄문에 스프링 컨테이너가 종료될때 @PreDestroy 같은 메서드가 실행되지 않는다.
- 스프링 컨테이너에 요청할 때마다 때마다 새로운 객체를 생성한다.
- 종료 메서드가 호출되지 않아서 클라이언트가 관리해야한다.

## 싱글톤과 프로토타입 스코프를 같이 사용할 때의 문제점
- 싱글톤빈과 함께 사용할 때는 프로토타입빈이 새로 생성되어 반환되지 않을 수가 있다.
- 싱글톤빈을 생성하면 싱글톤빈이 프로토 타입 빈을 사용하게 된다 그런데 싱글톤 빈은 생성 시점에만 의존 관계 주입을 받기 때문에, 프로토 타입 빈이 새로 생성되기는 하지만 싱글톤 빈과 함께 계속 유지되는 것이 문제다.
- 여러 빈에서 같은 프로토타입빈을 주입받으면 주입 받는 시점에 각각 새로운 프로토타입 빈이 생성된다. 하지만 사용할 때마다 새로 생성되는 것은 아니다.

## Provider 로 해결하기
- private ObjectProvider<PrototyeBean> prototypeBeanProvider;
- 지정한 빈을 컨테이너에서 대신 찾아주는 Dependency Look up 기능을 제공하는 것이 바로 ObjectProvider 이다.
- 프로바이더를 통해서 항상 새로운 프로토 타입 빈이 생성된다.
- 스프링이 제공하는 기능으로 딱 필요한 수준의 DL기능만 제공한다.
- 스프링에 의존한다.

## javax.inject.Provider
- Provider<PrototypeBean> prototypeBean;
- PrototypeBean bean = prototypeBean.get(); 으로 사용한다. 
- 스프링에 의존하지 않고 JSR-330 자바 표준을 사용한다.
- javax.inject::javax.inject:1 라이브러리 추가가 필요하다.

## 웹 스코프
- 웹 환경에서만 동작한다.
- 프로토타입과 다르게 스프링이 해당 스코프의 종료시점까지 관리해 종료 메서드를 호출한다.
- Request, session, application(서블릿컨텍스트), websocket 의 종류를 가지고 있다.

## 스코프와 프록시
- @Scope(proxyMode = ScopedProxyMode.TARGET_CLASS)
- 적용대상이 인터페이스냐 아니냐에 따라서 TARGET 이 달라진다.
- 프로바이더를 사용하는것과 똑같이 가짜 프록시 클래스를 만들어 주입시켜 준다.
